<!DOCTYPE html>
<html lang="pt-BR">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Pokemon TCG - Coleções</title>
        <link rel="stylesheet" href="css/style.css">
        <link rel="icon" href="Imagens/Icone.png" type="image/png">
    </head>
    
    <body>
        <header>
            <nav>
                <ul>
                    <li><a href="1-index.html">Início</a></li>
                    <li><a href="2-introducao.html">Introdução</a></li>
                    <li><a href="3-regras.html">Regras</a></li>
                    <li><a href="4-colecoes.html">Coleções</a></li>
                    <li><a href="5-campeonatos.html">Campeonatos</a></li>
                    <li><a href="6-digital.html">Digital</a></li>
                    <li><a href="7-curiosidades.html">Curiosidades</a></li>
                    <li><a href="8-fotos.html">Fotos</a></li>
                    <li><a href="9-videos.html">Vídeos</a></li>
                    <li><a href="10-tabela.html">Tabela</a></li>
                    <li><a href="formulario.html">Contato</a></li>
                    <li><a href="11-sobre.html">Autores</a></li>
                </ul>
            </nav>
        </header>

        <main>
            
            <section class="titulo-page">
                <h1>As diversas histórias</h1>
                <p class="textoP">
                    O TCG possui muitas coleções de cartas diferentes. Desse modo, como introdução a elas, explore as coleções "Fogo Branco" e "Raio Preto", cada uma trazendo uma nova era de cartas e estratégias para o Pokémon TCG.
                </p>
            </section>
            <!-- Dual Header Section -->
            <section class="bw-header bw-header--entry">
                <div class="bw-header__images">
                    <div class="bw-header__img black">
                        <div class="bw-header__logo-wrapper">
                            <div class="bw-header__logo">
                                
                            </div>
                        </div>
                    </div>
                    <div class="bw-header__img white">
                        <div class="bw-header__logo-wrapper logo-wrapper--right">
                            <div class="bw-header__logo">
                                
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Button Strip Below Images -->
                <div class="bw-header__button-strip">
                    <div class="bw-header__cta-wrapper">
                        <button class="button bw__cta bw__cta--primary bw__cta--blue" data-expansion="expansion-3">
                            <span class="button__bg" aria-hidden="true"></span>
                            <span class="button__bg button__bg__top" aria-hidden="true"></span>
                            <span class="button__content">
                                <span class="button__txt">
                                    <span class="label-1">Raio Preto</span>
                                </span>
                            </span>
                        </button>
                    </div>
                    <div class="bw-header__cta-wrapper">
                        <button class="button bw__cta bw__cta--primary bw__cta--pink" data-expansion="expansion-2">
                            <span class="button__bg" aria-hidden="true"></span>
                            <span class="button__bg button__bg__top" aria-hidden="true"></span>
                            <span class="button__content">
                                <span class="button__txt">
                                    <span class="label-1">Fogo Branco</span>
                                </span>
                            </span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Expansion 2: White Flare -->
            <section class="expansion-section" id="expansion-2">
                <div class="expansion-header">
      
                    <h2>Fogo Branco</h2>
                </div>
                <div class="expansion-content" data-json="./rsv10pt5.json"></div>
            </section>

            <!-- Expansion 3: Black Bolt -->
            <section class="expansion-section" id="expansion-3">
                <div class="expansion-header">
            
                    <h2>Raio Preto</h2>
                </div>
                <div class="expansion-content" data-json="./zsv10pt5.json"></div>
            </section>
        </main>

        <section class="flex-row">
                <aside class="anterior-pagina">
                    <a href="3-Regras.html">&laquo; Anterior: Regras</a>
                </aside>

                <aside class="proximo-pagina">
                    <a href="5-Campeonatos.html">Próximo: Campeonatos &raquo;</a>
                </aside>
                
            </section>

        <footer>
            <h1>Trabalho de Programação Web 1 - Hobby</h1>
        </footer>
        
        
        <script>
        // Gerenciador de dual header buttons
        const headerButtons = document.querySelectorAll('.bw__cta');
        const expansionSections = document.querySelectorAll('.expansion-section');

        headerButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const targetId = btn.dataset.expansion;
                
                // Remove active de todos
                expansionSections.forEach(s => s.classList.remove('active'));
                
                // Adiciona active no clicado
                const targetSection = document.getElementById(targetId);
                targetSection.classList.add('active');
                
                // Scroll suave até a seção
                targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
        });

        // Função para calcular cartas por página baseado na largura da tela
        function getCardsPerPage() {
            const width = window.innerWidth;
             // 5 colunas × 3 linhas
            if (width >= 880) return 10; // 4 colunas × 3 linhas
           
            if (width >= 580) return 6;   // 3 colunas × 2 linhas
            if (width >= 400) return 4;   // 2 colunas × 2 linhas
            return 4;                      // 2 colunas × 2 linhas (muito pequeno)
        }

        // Função reutilizável para criar carrossel
        function createCarousel(jsonPath, container) {
            (async () => {
                async function loadJson() {
                    const res = await fetch(jsonPath);
                    if (!res.ok) throw new Error('Arquivo não encontrado: ' + jsonPath);
                    return await res.json();
                }

                try {
                    const raw = await loadJson();
                    const cards = Array.isArray(raw) ? raw : (raw.data || []);
                    const unique = Array.from(new Map(cards.map(c => [c.id || JSON.stringify(c), c])).values());
                    const total = unique.length;

                    let currentPage = 0;
                    let cardsPerPage = getCardsPerPage(); // ← MUDANÇA AQUI
                    let totalPages = Math.ceil(unique.length / cardsPerPage);

                    const carouselContainer = document.createElement('div');
                    carouselContainer.className = 'carousel-container';

                    const prevBtn = document.createElement('button');
                    prevBtn.textContent = '◀';
                    prevBtn.className = 'carousel-nav carousel-nav-prev';
                    prevBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        if (currentPage > 0) {
                            currentPage--;
                            renderPage(currentPage);
                        }
                    });

                    const centerWrapper = document.createElement('div');
                    centerWrapper.className = 'center-wrapper';

                    const pageIndicator = document.createElement('span');
                    pageIndicator.className = 'page-indicator';

                    const rowView = document.createElement('div');
                    rowView.className = 'row-view';

                    centerWrapper.appendChild(pageIndicator);
                    centerWrapper.appendChild(rowView);

                    const nextBtn = document.createElement('button');
                    nextBtn.textContent = '▶';
                    nextBtn.className = 'carousel-nav carousel-nav-next';
                    nextBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        if (currentPage < totalPages - 1) {
                            currentPage++;
                            renderPage(currentPage);
                        }
                    });

                    carouselContainer.appendChild(prevBtn);
                    carouselContainer.appendChild(centerWrapper);
                    carouselContainer.appendChild(nextBtn);

                    container.appendChild(carouselContainer);

                    function renderPage(page) {
                        const prevBtnRef = carouselContainer.querySelector('.carousel-nav-prev');
                        const nextBtnRef = carouselContainer.querySelector('.carousel-nav-next');
                        
                        prevBtnRef.disabled = page === 0;
                        nextBtnRef.disabled = page === totalPages - 1;

                        rowView.style.opacity = '0';
                        
                        setTimeout(() => {
                            const start = page * cardsPerPage;
                            const end = start + cardsPerPage;
                            const pageCards = unique.slice(start, end);
                            
                            rowView.innerHTML = '';

                            // Remover placeholders - deixar grid auto-fit fazer o trabalho
                            pageCards.forEach(card => {
                                const imgUrl = (card.images && (card.images.small || card.images.large)) || card.image || '';
                                const imgEl = document.createElement('img');
                                imgEl.src = imgUrl;
                                imgEl.alt = card.name || '';
                                imgEl.loading = 'lazy';
                                rowView.appendChild(imgEl);
                            });

                            pageIndicator.textContent = `${page + 1} / ${totalPages}`;
                            rowView.style.opacity = '1';
                        }, 150);
                    }

                    // Recalcular ao redimensionar janela
                    let resizeTimeout;
                    window.addEventListener('resize', () => {
                        clearTimeout(resizeTimeout);
                        resizeTimeout = setTimeout(() => {
                            const newCardsPerPage = getCardsPerPage();
                            if (newCardsPerPage !== cardsPerPage) {
                                cardsPerPage = newCardsPerPage;
                                totalPages = Math.ceil(unique.length / cardsPerPage);
                                currentPage = Math.min(currentPage, totalPages - 1);
                                renderPage(currentPage);
                            }
                        }, 250);
                    });

                    renderPage(0);
                    console.log(`${jsonPath} loaded: ${total} cards`);
                } catch (err) {
                    console.error(err);
                    console.warn('Erro ao carregar ' + jsonPath + ', continuando...');
                }
            })();
        }

        // Carregar todas as expansões
        document.querySelectorAll('.expansion-content').forEach(container => {
            const jsonPath = container.dataset.json;
            createCarousel(jsonPath, container);
        });
        </script>
        
    </body>
</html>

